%Implemented is a version of a fast IDCT (runs approximately 30% faster)
function x = fastidct(y, C, s, a)
    
    y1 = [y(:, 1)./s(1), y(:, 5)./s(5), y(:, 3)./s(3), y(:, 7)./s(7), y(:, 6)./s(6), y(:, 2)./s(2), y(:, 8)./s(8), y(:, 4)./s(4)];

    y2 = horzcat([y1(:, 1:4)], 1/2*[y1(:, 5)-y1(:, 8), y1(:, 6)+y1(:, 7), ...
                                        y1(:, 6)-y1(:, 7), y1(:, 5)+y1(:, 8)]);

    y3 = [y2(:, 1:2), 1/2*(y2(:, 3)-y2(:, 4)), 1/2*(y2(:, 3)+y2(:, 4)), y2(:, 5), ...
                        1/2*(y2(:, 6)-y2(:, 8)), y2(:, 7), 1/2*(y2(:, 6)+y2(:, 8))];

    y4 = [y3(:, 1:2), y3(:, 3)/a(1), y3(:, 4), -(a(2)+a(5))*y3(:, 5)-a(5)*y3(:, 7), ...
                    y3(:, 6)/a(3), -a(5)*y3(:, 5)+y3(:, 7)*(a(4)-a(5)), y3(:, 8)];

    y5 = [1/2*(y4(:, 1)+y4(:, 2)), 1/2*(y4(:, 1)-y4(:, 2)), y4(:, 3)-y4(:, 4), ...
                                                        y4(:, 4), y4(:, 5:8)];

    y6 = horzcat(1/2*[y5(:, 1)+y5(:, 4), y5(:, 2)+y5(:, 3), y5(:, 2)-y5(:, 3), y5(:, 1)-y5(:, 4)], ...
            [y5(:, 7)-y5(:, 5)-y5(:, 6)-y5(:, 8), y5(:, 6)+y5(:, 8)-y5(:, 7), y5(:, 7)-y5(:, 8), y5(:, 8)]);

    x = 1/2*[y6(:, 1)+y6(:, 8), y6(:, 2)+y6(:, 7), y6(:, 3)+y6(:, 6), y6(:, 4)+y6(:, 5), ...
             y6(:, 4)-y6(:, 5), y6(:, 3)-y6(:, 6), y6(:, 2)-y6(:, 7), y6(:, 1)-y6(:, 8)];

end